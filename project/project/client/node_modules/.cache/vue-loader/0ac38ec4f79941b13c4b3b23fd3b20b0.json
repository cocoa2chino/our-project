{"remainingRequest":"D:\\newwork\\project\\project\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\newwork\\project\\project\\client\\src\\components\\nav.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\newwork\\project\\project\\client\\src\\components\\nav.vue","mtime":1654097538117},{"path":"D:\\newwork\\project\\project\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1654159187643},{"path":"D:\\newwork\\project\\project\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1654159189886},{"path":"D:\\newwork\\project\\project\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1654159187643},{"path":"D:\\newwork\\project\\project\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1654159190747}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICBleGl0LA0KICBnZXRMb2dpblVzZXIsDQogIGNoZWNrVXNlclB3ZCwNCiAgdXBkTG9naW5Vc2VySW5mbywNCiAgdXBkTG9naW5Vc2VyUHdkLA0KfSBmcm9tICIuLi9hcGkiOw0KDQppbXBvcnQgYXZhdGFyVXJsIGZyb20gJy4uL2Fzc2V0cy9hdmF0YXIucG5nJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgdmFyIGNoZWNrT2xkUHdkID0gYXN5bmMgKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgaWYgKHZhbHVlKSB7DQogICAgICAgIGF3YWl0IGNoZWNrVXNlclB3ZCh0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbiwgdmFsdWUpLnRoZW4oKHJlc3ApID0+IHsNCiAgICAgICAgICBpZihyZXNwLmNvZGUgIT0gMCl7DQogICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKHJlc3AubXNnKSk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi5Y6f5aeL5a+G56CB5b+F6aG76L6T5YWlIikpOw0KICAgICAgfQ0KICAgICAgY2FsbGJhY2soKTsNCiAgICB9Ow0KICAgIHZhciBjaGVja05ld1B3ZCA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICghdmFsdWUpIHsNCiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLkv67mlLnlr4bnoIHlv4XpobvovpPlhaUiKSk7DQogICAgICB9DQoNCiAgICAgIGNhbGxiYWNrKCk7DQogICAgfTsNCiAgICB2YXIgY2hlY2tSZVB3ZCA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICghdmFsdWUpIHsNCiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLnoa7orqTlr4bnoIHlv4XpobvovpPlhaUiKSk7DQogICAgICB9DQoNCiAgICAgIGlmICh2YWx1ZSAhPSB0aGlzLnVzZXJQd2QubmV3UHdkKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi5Lik5qyh6L6T5YWl5a+G56CB5LiN5LiA6Ie0IikpOw0KICAgICAgfQ0KDQogICAgICBjYWxsYmFjaygpOw0KICAgIH07DQogICAgcmV0dXJuIHsNCiAgICAgIHNob3dVcGRJbmZvRmxhZzogZmFsc2UsDQogICAgICBzaG93VXBkUHdkRmxhZzogZmFsc2UsDQogICAgICB1c2VyUHdkOiB7DQogICAgICAgIG9sZFB3ZDogIiIsDQogICAgICAgIG5ld1B3ZDogIiIsDQogICAgICAgIHJlUHdkOiAiIiwNCiAgICAgIH0sDQogICAgICB1c2VyUHdkRm9ybVJ1bGVzOiB7DQogICAgICAgIG9sZFB3ZDogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHZhbGlkYXRvcjogY2hlY2tPbGRQd2QsDQogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIsDQogICAgICAgICAgfSwNCiAgICAgICAgXSwNCiAgICAgICAgbmV3UHdkOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgdmFsaWRhdG9yOiBjaGVja05ld1B3ZCwNCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIiwNCiAgICAgICAgICB9LA0KICAgICAgICBdLA0KICAgICAgICByZVB3ZDogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHZhbGlkYXRvcjogY2hlY2tSZVB3ZCwNCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIiwNCiAgICAgICAgICB9LA0KICAgICAgICBdLA0KICAgICAgfSwNCiAgICAgIHVzZXJGb3JtOiB7DQogICAgICAgIGlkOiAiIiwNCiAgICAgICAgdXNlck5hbWU6ICIiLA0KICAgICAgICBwYXNzV29yZDogIiIsDQogICAgICAgIG5hbWU6ICIiLA0KICAgICAgICBnZW5kZXI6ICIiLA0KICAgICAgICBhZ2U6ICIiLA0KICAgICAgICBwaG9uZTogIiIsDQogICAgICB9LA0KICAgICAgYXZhdGFyVXJsOiBhdmF0YXJVcmwNCiAgICB9Ow0KICB9LA0KICBtZXRob2RzOiB7DQogICAgaGFuZGxlVXNlcihjb21tKSB7DQogICAgICBpZiAoY29tbSA9PSAiaW5mbyIpIHsNCiAgICAgICAgdGhpcy5zaG93VXBkSW5mb1dpbigpOw0KICAgICAgfQ0KDQogICAgICBpZiAoY29tbSA9PSAicHdkIikgew0KICAgICAgICB0aGlzLnNob3dVcGRQd2RXaW4oKTsNCiAgICAgIH0NCg0KICAgICAgaWYgKGNvbW0gPT0gImV4aXQiKSB7DQogICAgICAgIHRoaXMuJGNvbmZpcm0oIuehruiupOimgemAgOWHuuWQl++8nyIsICLns7vnu5/mj5DnpLoiLCB7DQogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICLnoa7orqQiLA0KICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLA0KICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwNCiAgICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgICAgZXhpdCh0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbikudGhlbigoKSA9PiB7DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImNsZWFyVG9rZW4iKTsNCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiY2xlYXJNZW51cyIpOw0KICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKTsNCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvIik7DQogICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgaW5pdFVzZXJQd2QoKSB7DQogICAgICB0aGlzLnVzZXJQd2QgPSB7DQogICAgICAgIG9sZFB3ZDogIiIsDQogICAgICAgIG5ld1B3ZDogIiIsDQogICAgICAgIHJlUHdkOiAiIiwNCiAgICAgIH07DQogICAgfSwNCiAgICBpbml0VXNlckZvcm0oKSB7DQogICAgICB0aGlzLnVzZXJGb3JtID0gew0KICAgICAgICBpZDogIiIsDQogICAgICAgIHVzZXJOYW1lOiAiIiwNCiAgICAgICAgcGFzc1dvcmQ6ICIiLA0KICAgICAgICBuYW1lOiAiIiwNCiAgICAgICAgZ2VuZGVyOiAiIiwNCiAgICAgICAgYWdlOiAiIiwNCiAgICAgICAgcGhvbmU6ICIiLA0KICAgICAgICB0b2tlbjogdGhpcy4kc3RvcmUuc3RhdGUudG9rZW4NCiAgICAgIH07DQogICAgfSwNCiAgICBzaG93VXBkSW5mb1dpbigpIHsNCiAgICAgIGdldExvZ2luVXNlcih0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbikudGhlbigocmVzcCkgPT4gew0KICAgICAgICB0aGlzLmluaXRVc2VyRm9ybSgpOw0KICAgICAgICB0aGlzLnVzZXJGb3JtID0gcmVzcC5kYXRhOw0KICAgICAgICB0aGlzLnNob3dVcGRJbmZvRmxhZyA9IHRydWU7DQogICAgICB9KTsNCiAgICB9LA0KICAgIHNob3dVcGRQd2RXaW4oKSB7DQogICAgICB0aGlzLmluaXRVc2VyUHdkKCk7DQogICAgICB0aGlzLnNob3dVcGRQd2RGbGFnID0gdHJ1ZTsNCiAgICB9LA0KICAgIHVwZEluZm8oKSB7DQoJCQ0KDQoJCXRoaXMudXNlckZvcm0udG9rZW4gPSB0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbjsNCiAgICAgIHVwZExvZ2luVXNlckluZm8odGhpcy51c2VyRm9ybSkudGhlbigocmVzcCkgPT4gew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICBtZXNzYWdlOiByZXNwLm1zZywNCiAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsDQogICAgICAgIH0pOw0KDQogICAgICAgIHRoaXMuc2hvd1VwZEluZm9GbGFnID0gZmFsc2U7DQogICAgICAgIHRoaXMuaW5pdFVzZXJGb3JtKCk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIHVwZFB3ZChmb3JtTmFtZSkgew0KICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7DQogICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgIHVwZExvZ2luVXNlclB3ZCh0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbiwgdGhpcy51c2VyUHdkLm5ld1B3ZCkudGhlbigocmVzcCkgPT4gew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3AubXNnLA0KICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgdGhpcy5zaG93VXBkUHdkRmxhZyA9IGZhbHNlOw0KICAgICAgICAgICAgdGhpcy5pbml0VXNlclB3ZCgpOw0KICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["nav.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"nav.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <el-header class=\"fater-header\">\r\n    \r\n    <el-dropdown @command=\"handleUser\" class=\"fater-header-user\">   \r\n        <el-avatar :size=\"40\" :src=\"avatarUrl\"></el-avatar>\r\n        <el-dropdown-menu slot=\"dropdown\">\r\n            <el-dropdown-item command=\"info\"><strong>个人信息</strong></el-dropdown-item>\r\n            <el-dropdown-item command=\"pwd\"><strong>修改密码</strong></el-dropdown-item>\r\n            <el-dropdown-item command=\"exit\"><strong>退出系统</strong></el-dropdown-item>\r\n        </el-dropdown-menu>\r\n    </el-dropdown>\r\n\r\n    <el-dialog\r\n      title=\"修改信息\" width=\"600px\"\r\n      :append-to-body=\"true\" :visible.sync=\"showUpdInfoFlag\">\r\n      <el-form label-width=\"80px\" :model=\"userForm\">\r\n          <el-form-item label=\"用户账号\">\r\n              <el-input v-model=\"userForm.userName\" \r\n                  placeholder=\"请输入用户账号…\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户姓名\">\r\n              <el-input v-model=\"userForm.name\" \r\n                  placeholder=\"请输入用户姓名…\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户年龄\">\r\n              <el-input v-model=\"userForm.age\" \r\n                  placeholder=\"请输入用户年龄…\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>  \r\n          <el-form-item label=\"用户性别\">\r\n              <el-radio-group v-model=\"userForm.gender\">\r\n                  <el-radio label=\"男\"></el-radio>\r\n                  <el-radio label=\"女\"></el-radio>\r\n              </el-radio-group>\r\n          </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"showUpdInfoFlag = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"updInfo()\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <el-dialog\r\n      title=\"修改密码\" width=\"600px\"\r\n      :append-to-body=\"true\" :visible.sync=\"showUpdPwdFlag\">\r\n      <el-form label-width=\"80px\"  ref=\"userPwd\" :model=\"userPwd\" :rules=\"userPwdFormRules\">\r\n          <el-form-item label=\"原始密码\" prop=\"oldPwd\">\r\n            <el-input\r\n                type=\"password\" v-model=\"userPwd.oldPwd\"\r\n                placeholder=\"请输入原始密码……\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n        <el-form-item label=\"修改密码\" prop=\"newPwd\">\r\n          <el-input\r\n              type=\"password\" v-model=\"userPwd.newPwd\"\r\n              placeholder=\"请输入修改密码……\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"确认密码\" prop=\"rePwd\">\r\n          <el-input\r\n            type=\"password\" v-model=\"userPwd.rePwd\"\r\n            placeholder=\"请再次确认密码……\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"showUpdPwdFlag = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"updPwd('userPwd')\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </el-header>\r\n</template>\r\n\r\n<style>\r\n</style>\r\n\r\n<script>\r\nimport {\r\n  exit,\r\n  getLoginUser,\r\n  checkUserPwd,\r\n  updLoginUserInfo,\r\n  updLoginUserPwd,\r\n} from \"../api\";\r\n\r\nimport avatarUrl from '../assets/avatar.png'\r\n\r\nexport default {\r\n  data() {\r\n    var checkOldPwd = async (rule, value, callback) => {\r\n      if (value) {\r\n        await checkUserPwd(this.$store.state.token, value).then((resp) => {\r\n          if(resp.code != 0){\r\n             callback(new Error(resp.msg));\r\n          }\r\n        });\r\n      } else {\r\n        callback(new Error(\"原始密码必须输入\"));\r\n      }\r\n      callback();\r\n    };\r\n    var checkNewPwd = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error(\"修改密码必须输入\"));\r\n      }\r\n\r\n      callback();\r\n    };\r\n    var checkRePwd = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error(\"确认密码必须输入\"));\r\n      }\r\n\r\n      if (value != this.userPwd.newPwd) {\r\n        callback(new Error(\"两次输入密码不一致\"));\r\n      }\r\n\r\n      callback();\r\n    };\r\n    return {\r\n      showUpdInfoFlag: false,\r\n      showUpdPwdFlag: false,\r\n      userPwd: {\r\n        oldPwd: \"\",\r\n        newPwd: \"\",\r\n        rePwd: \"\",\r\n      },\r\n      userPwdFormRules: {\r\n        oldPwd: [\r\n          {\r\n            validator: checkOldPwd,\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        newPwd: [\r\n          {\r\n            validator: checkNewPwd,\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        rePwd: [\r\n          {\r\n            validator: checkRePwd,\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n      },\r\n      userForm: {\r\n        id: \"\",\r\n        userName: \"\",\r\n        passWord: \"\",\r\n        name: \"\",\r\n        gender: \"\",\r\n        age: \"\",\r\n        phone: \"\",\r\n      },\r\n      avatarUrl: avatarUrl\r\n    };\r\n  },\r\n  methods: {\r\n    handleUser(comm) {\r\n      if (comm == \"info\") {\r\n        this.showUpdInfoWin();\r\n      }\r\n\r\n      if (comm == \"pwd\") {\r\n        this.showUpdPwdWin();\r\n      }\r\n\r\n      if (comm == \"exit\") {\r\n        this.$confirm(\"确认要退出吗？\", \"系统提示\", {\r\n          confirmButtonText: \"确认\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        }).then(() => {\r\n          exit(this.$store.state.token).then(() => {\r\n            this.$store.commit(\"clearToken\");\r\n            this.$store.commit(\"clearMenus\");\r\n            sessionStorage.clear();\r\n            this.$router.push(\"/\");\r\n          });\r\n        });\r\n      }\r\n    },\r\n    initUserPwd() {\r\n      this.userPwd = {\r\n        oldPwd: \"\",\r\n        newPwd: \"\",\r\n        rePwd: \"\",\r\n      };\r\n    },\r\n    initUserForm() {\r\n      this.userForm = {\r\n        id: \"\",\r\n        userName: \"\",\r\n        passWord: \"\",\r\n        name: \"\",\r\n        gender: \"\",\r\n        age: \"\",\r\n        phone: \"\",\r\n        token: this.$store.state.token\r\n      };\r\n    },\r\n    showUpdInfoWin() {\r\n      getLoginUser(this.$store.state.token).then((resp) => {\r\n        this.initUserForm();\r\n        this.userForm = resp.data;\r\n        this.showUpdInfoFlag = true;\r\n      });\r\n    },\r\n    showUpdPwdWin() {\r\n      this.initUserPwd();\r\n      this.showUpdPwdFlag = true;\r\n    },\r\n    updInfo() {\r\n\t\t\r\n\r\n\t\tthis.userForm.token = this.$store.state.token;\r\n      updLoginUserInfo(this.userForm).then((resp) => {\r\n        this.$message({\r\n          message: resp.msg,\r\n          type: \"success\",\r\n        });\r\n\r\n        this.showUpdInfoFlag = false;\r\n        this.initUserForm();\r\n      });\r\n    },\r\n    updPwd(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          updLoginUserPwd(this.$store.state.token, this.userPwd.newPwd).then((resp) => {\r\n            this.$message({\r\n              message: resp.msg,\r\n              type: \"success\",\r\n            });\r\n\r\n            this.showUpdPwdFlag = false;\r\n            this.initUserPwd();\r\n          });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>"]}]}